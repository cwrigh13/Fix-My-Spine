<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= typeof title !== 'undefined' ? title : 'Fix My Spine | Find Trusted Health Professionals' %></title>
    <meta name="description" content="<%= typeof description !== 'undefined' ? description : 'Your trusted directory for Chiropractors, Physiotherapists, and more in Australia.' %>">
    <link rel="canonical" href="<%= typeof canonicalUrl !== 'undefined' ? canonicalUrl : 'https://fixmyspine.com.au/' %>">
    <link rel="alternate" hreflang="en-au" href="<%= typeof canonicalUrl !== 'undefined' ? canonicalUrl : 'https://fixmyspine.com.au/' %>">
    <link rel="alternate" hreflang="x-default" href="<%= typeof canonicalUrl !== 'undefined' ? canonicalUrl : 'https://fixmyspine.com.au/' %>">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="<%= typeof canonicalUrl !== 'undefined' ? canonicalUrl : 'https://fixmyspine.com.au/' %>">
    <meta property="og:title" content="<%= typeof title !== 'undefined' ? title : 'Fix My Spine | Find Trusted Health Professionals' %>">
    <meta property="og:description" content="<%= typeof description !== 'undefined' ? description : 'Your trusted directory for Chiropractors, Physiotherapists, and more in Australia.' %>">
    <meta property="og:site_name" content="Fix My Spine">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="<%= typeof canonicalUrl !== 'undefined' ? canonicalUrl : 'https://fixmyspine.com.au/' %>">
    <meta name="twitter:title" content="<%= typeof title !== 'undefined' ? title : 'Fix My Spine | Find Trusted Health Professionals' %>">
    <meta name="twitter:description" content="<%= typeof description !== 'undefined' ? description : 'Your trusted directory for Chiropractors, Physiotherapists, and more in Australia.' %>">
    
    <link rel="stylesheet" href="/stylesheets/dist.css?v=7">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="/javascripts/search-bar.js" defer></script>
    
    <!-- Organization Schema for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Fix My Spine",
        "alternateName": "FixMySpine",
        "url": "https://fixmyspine.com.au",
        "logo": "https://fixmyspine.com.au/images/logo.png",
        "description": "Australia's trusted directory for finding chiropractors, physiotherapists, and allied health professionals. Search by location, specialty, and read verified patient reviews.",
        "address": {
            "@type": "PostalAddress",
            "addressCountry": "AU"
        },
        "sameAs": [
            "https://www.facebook.com/fixmyspine",
            "https://twitter.com/fixmyspine"
        ],
        "contactPoint": {
            "@type": "ContactPoint",
            "contactType": "customer service",
            "url": "https://fixmyspine.com.au/contact"
        },
        "areaServed": {
            "@type": "Country",
            "name": "Australia"
        },
        "knowsAbout": [
            "Chiropractic",
            "Physiotherapy",
            "Osteopathy",
            "Massage Therapy",
            "Sports Medicine",
            "Pain Management",
            "Allied Health"
        ]
    }
    </script>
    
    <!-- FAQ Schema for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "How do I find a chiropractor or physiotherapist near me?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Use our search tool on the homepage to find healthcare professionals by postcode, suburb, or specialty. You can filter by category (chiropractor, physiotherapist, etc.) and read verified patient reviews to help you make an informed decision."
                }
            },
            {
                "@type": "Question",
                "name": "Are the practitioners on FixMySpine verified?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes, all practitioners listed on FixMySpine are verified healthcare professionals. We work only with licensed, registered practitioners who meet professional standards in their respective fields."
                }
            },
            {
                "@type": "Question",
                "name": "Is it free to search for healthcare professionals?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes, searching for healthcare professionals on FixMySpine is completely free. You can browse listings, read reviews, and contact practitioners at no cost."
                }
            },
            {
                "@type": "Question",
                "name": "How can I list my practice on FixMySpine?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Healthcare practitioners can list their practice by clicking 'List Your Practice' in the navigation menu. We offer both free basic listings and premium listings with enhanced visibility and features. Visit our pricing page to learn more."
                }
            }
        ]
    }
    </script>
</head>
<body class="bg-background">
    <!-- Navigation -->
    <nav class="bg-white shadow-md fixed top-0 left-0 right-0 z-50">
        <div class="max-w-5xl mx-auto px-3 sm:px-4 lg:px-6 w-full">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <a href="/" class="text-2xl font-heading font-bold text-primary">
                        FixMySpine
                    </a>
                </div>
                
                <!-- Desktop Navigation -->
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="/" class="text-text hover:text-primary px-3 py-2 rounded-md text-sm font-medium">Home</a>
                        <a href="/about" class="text-text hover:text-primary px-3 py-2 rounded-md text-sm font-medium">About</a>
                        <a href="/blog/" class="text-text hover:text-primary px-3 py-2 rounded-md text-sm font-medium">Blog</a>
                        <a href="/contact" class="text-text hover:text-primary px-3 py-2 rounded-md text-sm font-medium">Contact</a>
                        <% if (typeof user !== 'undefined' && user) { %>
                            <a href="/dashboard" class="text-text hover:text-primary px-3 py-2 rounded-md text-sm font-medium">Dashboard</a>
                            <% if (user.isAdmin) { %>
                                <a href="/admin/dashboard" class="text-text hover:text-primary px-3 py-2 rounded-md text-sm font-medium">Admin</a>
                            <% } %>
                            <a href="/logout" class="btn-secondary">Logout</a>
                        <% } else { %>
                            <a href="/login" class="text-text hover:text-primary px-3 py-2 rounded-md text-sm font-medium">Login</a>
                            <a href="/register" class="btn-primary">List Your Practice</a>
                        <% } %>
                    </div>
                </div>
                
            </div>
        </div>
        
    </nav>
    

    <!-- Hero Section -->
    <section class="hero-bg min-h-screen flex items-center pt-16">
        <div class="max-w-4xl mx-auto px-3 sm:px-4 lg:px-6 py-8 w-full">
            <div class="text-center">
                <h1 class="text-4xl md:text-6xl font-heading font-bold text-white mb-6">
                    Find Trusted Chiropractors & Allied Health Professionals Across Australia
                </h1>
                <p class="text-xl text-white mb-8">
                    Connect with verified healthcare professionals in your area. Read real patient reviews and find the perfect practitioner for your needs.
                </p>
                
                <!-- Modern Search Bar -->
                <div class="w-full">
                    <form action="/search" method="GET" class="modern-search-container">
                        <div class="modern-search-wrapper">
                            <!-- Search Field -->
                            <div class="modern-search-field">
                                <label for="keyword" class="modern-search-label">Search</label>
                                <input 
                                    type="text" 
                                    id="keyword" 
                                    name="keyword" 
                                    placeholder="Condition, procedure or doctor name"
                                    class="modern-search-input"
                                >
                            </div>
                            
                            <!-- Postcode Field -->
                            <div class="modern-search-field modern-search-divider">
                                <label for="postcode" class="modern-search-label">Postcode</label>
                                <input 
                                    type="text" 
                                    id="postcode" 
                                    name="postcode" 
                                    placeholder="Enter your postcode"
                                    pattern="[0-9]{4}"
                                    maxlength="4"
                                    class="modern-search-input"
                                    title="Please enter a valid 4-digit Australian postcode"
                                >
                            </div>
                            
                            <!-- Specialty Field -->
                            <div class="modern-search-field modern-search-divider">
                                <label for="category" class="modern-search-label">Specialty</label>
                                <select id="category" name="category" class="modern-search-input modern-select">
                                    <option value="">Select specialty...</option>
                                    <% categories.forEach(category => { %>
                                        <option value="<%= category.id %>">&nbsp;&nbsp;<%= category.name %></option>
                                    <% }); %>
                                </select>
                            </div>
                            
                            <!-- Search Button -->
                            <button type="submit" class="modern-search-button">
                                <svg class="modern-search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                </svg>
                                Find care
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Practitioners Section -->
    <% if (Array.isArray(featuredListings) && featuredListings.length > 0) { %>
    <section class="py-20 bg-white">
        <div class="max-w-5xl mx-auto px-3 sm:px-4 lg:px-6 w-full">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-heading font-bold text-text mb-4">
                    Featured Practitioners
                </h2>
                <p class="text-lg text-muted">
                    Explore some of the top-rated practitioners on FixMySpine.
                </p>
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <% featuredListings.forEach(function(listing) { %>
                    <% 
                    // Prioritize Google rating over internal rating
                    const displayRating = listing.google_rating || listing.avg_rating;
                    const displayReviewCount = listing.google_review_count || listing.review_count;
                    const avgRating = displayRating ? parseFloat(displayRating).toFixed(1) : '0.0';
                    const reviewCount = Number(displayReviewCount || 0);
                    %>
                    <% const slug = (listing.business_name || '').toLowerCase().replace(/[^a-z0-9\s-]/g, '').trim().replace(/\s+/g, '-'); %>
                    <a href="/listing/<%= listing.id %>/<%= slug %>" class="block bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow border border-gray-100 p-6">
                        <div class="flex items-start justify-between">
                            <div>
                                <h3 class="text-lg font-semibold text-text"><%= listing.business_name %></h3>
                                <p class="text-sm text-muted mt-1">
                                    <%= listing.category_name || '' %>
                                </p>
                            </div>
                            <% if (avgRating > 0) { %>
                                <div class="ml-4 text-right">
                                    <div class="inline-flex items-center px-2 py-1 rounded bg-yellow-50 text-yellow-700 text-sm font-medium">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.802 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.802-2.034a1 1 0 00-1.175 0l-2.802 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81H7.03a1 1 0 00.95-.69l1.07-3.292z" />
                                        </svg>
                                        <span><%= avgRating %></span>
                                    </div>
                                    <div class="text-xs text-muted mt-1">
                                        <%= reviewCount %> review<%= reviewCount === 1 ? '' : 's' %>
                                    </div>
                                </div>
                            <% } %>
                        </div>

                        <div class="mt-4 text-sm text-text/80">
                            <span><%= listing.suburb %><% if (listing.state) { %>, <%= listing.state %><% } %></span>
                        </div>

                        <% if (listing.description) { %>
                        <p class="mt-3 text-sm text-muted line-clamp-2"><%= listing.description %></p>
                        <% } %>

                        <div class="mt-6">
                            <span class="inline-flex items-center text-primary font-medium">
                                View profile
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                                </svg>
                            </span>
                        </div>
                    </a>
                <% }); %>
            </div>
        </div>
    </section>
    <% } %>

    <!-- Categories Section -->
    <section class="py-20 bg-secondary">
        <div class="max-w-6xl mx-auto px-3 sm:px-4 lg:px-6">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl font-heading font-bold text-text mb-4">
                    Browse by Specialty
                </h2>
                <p class="text-lg text-muted max-w-2xl mx-auto">
                    Find the right type of healthcare professional for your specific needs.
                </p>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6">
                <% categories.slice(0, 12).forEach(category => { %>
                    <a href="/category/<%= category.slug %>" 
                       class="bg-white rounded-lg p-6 text-center hover:shadow-md transition-shadow duration-300 group border-2 border-black">
                        <div class="w-12 h-12 bg-primary rounded-full flex items-center justify-center mx-auto mb-3 group-hover:bg-primary/90 transition-colors" role="img" aria-label="<%= category.name %> category icon">
                            <span class="text-white font-bold text-lg">
                                <%= category.name.charAt(0) %>
                            </span>
                        </div>
                        <h3 class="font-semibold text-text text-sm"><%= category.name %></h3>
                    </a>
                <% }); %>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="py-20 bg-primary">
        <div class="max-w-4xl mx-auto text-center px-3 sm:px-4 lg:px-6">
            <h2 class="text-3xl md:text-4xl font-heading font-bold text-white mb-6">
                Ready to Find Your Perfect Healthcare Professional?
            </h2>
            <p class="text-xl text-white/90 mb-8">
                Join thousands of Australians who have found trusted healthcare providers through FixMySpine.
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="/search" class="btn-accent">
                    Start Your Search
                </a>
                <% if (typeof user === 'undefined' || !user) { %>
                    <a href="/register" class="btn-secondary">
                        List Your Practice
                    </a>
                <% } %>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-text text-white py-12">
        <div class="max-w-5xl mx-auto px-3 sm:px-4 lg:px-6 w-full">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <p class="text-xl font-heading font-bold mb-4">FixMySpine</p>
                    <p class="text-white/80">
                        Connecting Australians with trusted healthcare professionals.
                    </p>
                </div>
                <div>
                    <p class="font-semibold mb-4">Company</p>
                    <ul class="space-y-2">
                        <li><a href="/about" class="text-white/80 hover:text-white">About Us</a></li>
                        <li><a href="/contact" class="text-white/80 hover:text-white">Contact</a></li>
                    </ul>
                </div>
                <div>
                    <p class="font-semibold mb-4">For Practitioners</p>
                    <ul class="space-y-2">
                        <li><a href="/register" class="text-white/80 hover:text-white">Register</a></li>
                        <li><a href="/login" class="text-white/80 hover:text-white">Login</a></li>
                        <li><a href="/dashboard" class="text-white/80 hover:text-white">Dashboard</a></li>
                    </ul>
                </div>
                <div>
                    <p class="font-semibold mb-4">Legal</p>
                    <ul class="space-y-2">
                        <li><a href="/terms-of-service" class="text-white/80 hover:text-white">Terms of Service</a></li>
                        <li><a href="/privacy-policy" class="text-white/80 hover:text-white">Privacy Policy</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-white/20 mt-8 pt-8 text-center">
                <p class="text-white/80">&copy; 2024 FixMySpine. All rights reserved.</p>
            </div>
        </div>
    </footer>
</body>
</html>
